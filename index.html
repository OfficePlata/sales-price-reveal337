<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>売上実績表示（発表モード対応）</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&display=swap" rel="stylesheet">
    
    <style>
        body {
            background-color: #fff;
            color: #333;
            font-family: 'Meiryo', 'メイリオ', sans-serif;
            text-align: center;
            padding: 0;
            margin: 0;
        }
        .header {
            background-color: #FF9500;
            padding: 40px 20px;
            margin: 0;
        }
        .header h1 {
            color: white;
            font-size: 3.5rem;
            margin: 0;
            font-weight: bold;
        }
        .period {
            font-size: 2rem;
            color: #333;
            margin: 30px 0;
            font-weight: bold;
        }
        .data-box {
            background-color: #0066FF;
            color: white;
            padding: 40px 80px;
            margin: 30px auto;
            display: inline-block;
            border-radius: 10px;
            min-width: 600px;
        }
        .data-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 20px 0;
            font-size: 2.5rem;
            font-weight: bold;
        }
        .data-label {
            text-align: left;
            min-width: 200px;
        }
        .data-value {
            text-align: right;
            font-family: 'Orbitron', sans-serif;
            font-size: 3rem;
        }
        .cumulative-section {
            margin-top: 80px;
        }
        .cumulative-title {
            font-size: 2rem;
            color: #333;
            margin: 30px 0;
            font-weight: bold;
        }
        .cumulative-data {
            font-size: 3rem;
            color: #333;
            font-weight: bold;
            margin: 20px 0;
        }
        .cumulative-value {
            font-family: 'Orbitron', sans-serif;
        }
        /* 桁ごとの数字スタイル */
        .data-value span, .cumulative-value span, #amount-row-total span {
            font-family: 'Orbitron', sans-serif;
            transition: opacity 0.3s ease-in;
        }
        .btn {
            font-size: 1.8rem;
            padding: 15px 40px;
            font-weight: bold;
            cursor: pointer;
            border: none;
            border-radius: 8px;
            margin: 20px;
            color: white;
            background-color: #FF9500;
            transition: background-color 0.3s;
        }
        .btn:hover {
            background-color: #e68600;
        }
        .btn:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        /* 鑑定板は非表示 */
        #price-board-monthly, #price-board-total {
            display: none;
        }
    </style>
</head>
<body>

    <div class="header">
        <h1>10月売上実績報告</h1>
    </div>

    <div class="period">集計期間：9月25日～10月22日</div>

    <input type="number" id="salesInputMonthly" value="260218827" style="display:none;">
    <input type="number" id="countInputMonthly" value="263" style="display:none;">

    <button id="revealButtonMonthly" class="btn">表示</button>

    <div id="monthly-data-box" class="data-box" style="display:none;">
        <div class="data-row">
            <span class="data-label">受注件数</span>
            <span class="data-value" id="count-display-monthly">0</span>
            <span style="font-size: 2.5rem;">件</span>
        </div>
        <div class="data-row" id="amount-row-monthly" style="display:none;">
            <span class="data-label">受注金額</span>
            <div class="data-value" style="display: inline-flex; align-items: baseline;">
                <span id="digit-9-monthly" style="opacity: 0;">0</span>,
                <span id="digit-8-monthly" style="opacity: 0;">0</span>
                <span id="digit-7-monthly" style="opacity: 0;">0</span>
                <span id="digit-6-monthly" style="opacity: 0;">0</span>,
                <span id="digit-5-monthly" style="opacity: 0;">0</span>
                <span id="digit-4-monthly" style="opacity: 0;">0</span>
                <span id="digit-3-monthly" style="opacity: 0;">0</span>,
                <span id="digit-2-monthly" style="opacity: 0;">0</span>
                <span id="digit-1-monthly" style="opacity: 0;">0</span>
                <span id="digit-0-monthly" style="opacity: 0;">0</span>
            </div>
            <span style="font-size: 2.5rem;">円</span>
        </div>
    </div>

    <div class="cumulative-section">
        <div class="cumulative-title">令和6年度 売上累計（R6年10月～現在）</div>
        
        <input type="number" id="salesInputTotal" value="2501480432" style="display:none;">
        <input type="number" id="countInputTotal" value="2177" style="display:none;">

        <button id="revealButtonTotal" class="btn">表示</button>

        <div id="total-data" class="cumulative-data" style="display:none;">
            <div style="margin: 30px 0;">
                <span id="count-display-total" class="cumulative-value">0</span>件
            </div>
            <div id="amount-row-total" style="display:none; margin: 30px 0;">
                <span id="digit-9-total" style="opacity: 0;">0</span>,
                <span id="digit-8-total" style="opacity: 0;">0</span>
                <span id="digit-7-total" style="opacity: 0;">0</span>
                <span id="digit-6-total" style="opacity: 0;">0</span>,
                <span id="digit-5-total" style="opacity: 0;">0</span>
                <span id="digit-4-total" style="opacity: 0;">0</span>
                <span id="digit-3-total" style="opacity: 0;">0</span>,
                <span id="digit-2-total" style="opacity: 0;">0</span>
                <span id="digit-1-total" style="opacity: 0;">0</span>
                <span id="digit-0-total" style="opacity: 0;">0</span>円
            </div>
        </div>
    </div>

    <div id="price-board-monthly" style="display:none;"></div>
    <div id="price-board-total" style="display:none;"></div>


    <audio id="sound-0" src="いち.mp3" preload="auto"></audio> <audio id="sound-1" src="じゅう.mp3" preload="auto"></audio> <audio id="sound-2" src="ひゃく.mp3" preload="auto"></audio> <audio id="sound-3" src="せん.mp3" preload="auto"></audio> <audio id="sound-4" src="まん.mp3" preload="auto"></audio> <audio id="sound-5" src="じゅうまん.mp3" preload="auto"></audio> <audio id="sound-6" src="ひゃくまん.mp3" preload="auto"></audio> <audio id="sound-7" src="せんまん.mp3" preload="auto"></audio> <audio id="sound-8" src="いちおく.mp3" preload="auto"></audio> <audio id="sound-9" src="じゅうおく.mp3" preload="auto"></audio> <script>
        /*
         * JavaScript: サイトの「仕組み」
         */

        // ページが読み込まれた時に、まずURLをチェックする
        window.addEventListener('DOMContentLoaded', () => {

            // --- ★★★ ここからが追加した「発表モード」の仕掛け ★★★ ---
            
            const urlParams = new URLSearchParams(window.location.search);
            const monthlyAmount = urlParams.get('m'); // ?m=... の値
            const totalAmount = urlParams.get('t');   // ?t=... の値

            const inputMonthly = document.getElementById('salesInputMonthly');
            const inputTotal = document.getElementById('salesInputTotal');

            // 'm' または 't' がURLに存在する場合、「発表モード」と判断
            if (monthlyAmount || totalAmount) {
                
                // 両方の入力欄を非表示にする
                if (inputMonthly) inputMonthly.style.display = 'none';
                if (inputTotal) inputTotal.style.display = 'none';

                // URLに 'm' があれば、その値を「先月」の入力欄にセット
                if (monthlyAmount) {
                    inputMonthly.value = monthlyAmount;
                }
                // URLに 't' があれば、その値を「累計」の入力欄にセット
                if (totalAmount) {
                    inputTotal.value = totalAmount;
                }
            }
            // --- ★★★ 追加した仕掛けはここまで ★★★ ---


            // --- ここから下は、前回作成した表示処理（変更なし） ---

            // --- 共通の部品 ---
            const audioElements = [
                document.getElementById('sound-0'),
                document.getElementById('sound-1'),
                document.getElementById('sound-2'),
                document.getElementById('sound-3'),
                document.getElementById('sound-4'),
                document.getElementById('sound-5'),
                document.getElementById('sound-6'),
                document.getElementById('sound-7'),
                document.getElementById('sound-8'),
                document.getElementById('sound-9')
            ];
            
            let isMonthlyRunning = false;
            let isTotalRunning = false;
            const revealDelay = 800; 

            
            // --- 1. 先月セクションの処理 ---
            const revealButtonMonthly = document.getElementById('revealButtonMonthly');
            const countInputMonthly = document.getElementById('countInputMonthly');
            const countDisplayMonthly = document.getElementById('count-display-monthly');

            const monthlyDataBox = document.getElementById('monthly-data-box');
            const amountRowMonthly = document.getElementById('amount-row-monthly');
            const digitElementsMonthly = [
                document.getElementById('digit-0-monthly'),
                document.getElementById('digit-1-monthly'),
                document.getElementById('digit-2-monthly'),
                document.getElementById('digit-3-monthly'),
                document.getElementById('digit-4-monthly'),
                document.getElementById('digit-5-monthly'),
                document.getElementById('digit-6-monthly'),
                document.getElementById('digit-7-monthly'),
                document.getElementById('digit-8-monthly'),
                document.getElementById('digit-9-monthly')
            ];

            revealButtonMonthly.addEventListener('click', () => {
                if (isMonthlyRunning) return;
                
                const count = countInputMonthly.value;
                const amount = inputMonthly.value;
                
                if (count && amount) {
                    isMonthlyRunning = true;
                    revealButtonMonthly.disabled = true;
                    monthlyDataBox.style.display = 'inline-block';
                    
                    // 件数を即座に表示（音声なし）
                    countDisplayMonthly.textContent = parseInt(count).toLocaleString();
                    
                    // 少し待ってから金額行を表示し、一桁ずつアニメーション
                    setTimeout(() => {
                        amountRowMonthly.style.display = 'flex';
                        revealDigitByDigit(amount, digitElementsMonthly, () => {
                            isMonthlyRunning = false;
                            revealButtonMonthly.style.display = 'none';
                        });
                    }, 500);
                }
            });


            // --- 2. 累計セクションの処理 ---
            const revealButtonTotal = document.getElementById('revealButtonTotal');
            const countInputTotal = document.getElementById('countInputTotal');
            const countDisplayTotal = document.getElementById('count-display-total');

            const totalData = document.getElementById('total-data');
            const amountRowTotal = document.getElementById('amount-row-total');
            const digitElementsTotal = [
                document.getElementById('digit-0-total'),
                document.getElementById('digit-1-total'),
                document.getElementById('digit-2-total'),
                document.getElementById('digit-3-total'),
                document.getElementById('digit-4-total'),
                document.getElementById('digit-5-total'),
                document.getElementById('digit-6-total'),
                document.getElementById('digit-7-total'),
                document.getElementById('digit-8-total'),
                document.getElementById('digit-9-total')
            ];

            revealButtonTotal.addEventListener('click', () => {
                if (isTotalRunning) return;
                
                const count = countInputTotal.value;
                const amount = inputTotal.value;
                
                if (count && amount) {
                    isTotalRunning = true;
                    revealButtonTotal.disabled = true;
                    totalData.style.display = 'block';
                    
                    // 件数を即座に表示（音声なし）
                    countDisplayTotal.textContent = parseInt(count).toLocaleString();
                    
                    // 少し待ってから金額行を表示し、一桁ずつアニメーション
                    setTimeout(() => {
                        amountRowTotal.style.display = 'block';
                        revealDigitByDigit(amount, digitElementsTotal, () => {
                            isTotalRunning = false;
                            revealButtonTotal.style.display = 'none';
                        });
                    }, 500);
                }
            });


            // --- 3. 共通の一桁ずつ表示関数（音声付き） ---
            function revealDigitByDigit(amount, digitElements, callback) {
                // 金額を10桁にパディング
                const amountString = String(amount).padStart(10, '0');
                const digits = amountString.split('').reverse(); // 一の位から順に
                let index = 0;

                function showNextDigit() {
                    if (index >= digits.length) {
                        if (callback) callback();
                        return;
                    }
                    
                    // 桁の数字を設定して表示
                    digitElements[index].textContent = digits[index];
                    digitElements[index].style.opacity = '1';
                    digitElements[index].style.transition = 'opacity 0.3s ease-in';
                    
                    // 音声を再生
                    const soundToPlay = audioElements[index];
                    if (soundToPlay) {
                        soundToPlay.currentTime = 0;
                        soundToPlay.play().catch(e => console.error("音声の再生に失敗しました:", e));
                    }
                    
                    index++;
                    setTimeout(showNextDigit, revealDelay);
                }
                
                showNextDigit();
            }



        }); // 'DOMContentLoaded' イベントリスナーの終わり
    </script>

</body>
</html>
